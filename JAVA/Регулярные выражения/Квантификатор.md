_Метасимволы для обозначения количества символов – квантификаторы. Квантификатор всегда следует после символа или группы символов._

|Метасимвол|Назначение|
|---|---|
|?|один или отсутствует|
|*|ноль или более раз|
|+|один или более раз|
|{n}|n раз|
|{n,}|n раз и более|
|{n,m}|не менее n раз и не более m раз|

## Жадный режим квантификатора

Особенностью квантификаторов является возможность использования их в разных режимах: жадном, сверхжадном и ленивом. **Сверхжадный режим** включается добавлением символа «`+`» после квантификатора, а ленивый – символа «`?`». Например:

`"А.+а" // жадный режим "А.++а" // сверхжадный режим "А.+?а" // ленивый режим`

Попробуем на примере этого шаблона разобраться в работе квантификаторов в различных режимах. По умолчанию квантификатор работает в жадном режиме. Это означает, что он ищет максимально длинное совпадение в строке. В результате выполнения этого кода:

`public static void main(String[] args) {     String text = "Егор Алла Александр";     Pattern pattern = Pattern.compile("А.+а");     Matcher matcher = pattern.matcher(text);     while (matcher.find()) {         System.out.println(text.substring(matcher.start(), matcher.end()));     } }`

**мы получим такой вывод: _Алла Алекса_** Алгоритм поиска по заданному шаблону "`А.+а`", выполняется в следующей последовательности:

1. В заданном шаблоне первый символ – это русский символ буквы `А`. `Matcher` сопоставляет его с каждым символом текста, начиная с нулевой позиции. На нулевой позиции в нашем тексте находиться символ `Е`, поэтому `Matcher` перебирает последовательно символы в тексте, пока не встретит совпадение с шаблоном. В нашем примере это символ на позиции №5.
    
    ![Регулярные выражения в Java - 2](https://cdn.javarush.com/images/article/025a11b5-cffb-4158-9838-a50ff1659893/800.webp)
2. После того, как найдено совпадение с первым символом шаблона, `Matcher` сверяет соответствие со вторым символом шаблона. В нашем случае это символ «`.`», который обозначает любой символ.
    
    ![Регулярные выражения в Java - 3](https://cdn.javarush.com/images/article/d5995c0d-e88a-4627-845e-6cd3081289e0/800.webp)
    
    На шестой позиции – символ буквы `л`. Разумеется, он соответствует шаблону «любой символ».
    
3. `Matcher` переходит к проверке следующего символа из шаблона. В нашем шаблоне он задан с помощью квантификатора «`.+`». Поскольку количество повторений «любого символа» в шаблоне – один и более раз, `Matcher` берет по очереди следующий символ из строки и проверяет его на соответствие шаблону, до тех пор, пока будет выполняться условие «любой символ», в нашем примере – до конца строки (с поз. №7 -№18 текста).
    
    ![Регулярные выражения в Java - 4](https://cdn.javarush.com/images/article/2880ac59-56a2-42c9-b6d3-285241d3e3db/800.webp)
    
    По сути, `Matcher`, захватывает все строку до конца – в этом как раз и проявляется его «жадность».
    
4. После того как `Matcher` дошел до конца текста и закончил проверку для части шаблона «`А.+`», Matcher начинает проверку для оставшейся части шаблона – символ буквы `а`. Так как текст в прямом направлении закончился, проверка происходит в обратном направлении, начиная с последнего символа:
    
    ![Регулярные выражения в Java - 5](https://cdn.javarush.com/images/article/4edc0442-3476-4827-8b0a-f60944f030c9/800.webp)
5. `Matcher` «помнит» количество повторений в шаблоне «`.+`» при котором он дошел до конца текста, поэтому он уменьшает количество повторений на единицу и проверяет соответствие шаблона тексту, до тех пор пока не будет найдено совпадение:![Регулярные выражения в Java - 6](https://cdn.javarush.com/images/article/f7c55fca-83fb-4292-9485-fe9aa7449f50/800.webp)
    

## Сверхжадный режим квантификатора

В сверхжадном режиме работа матчера аналогична механизму жадного режима. Отличие состоит в том, что при захватывании текста до конца строки поиск в обратном направлении не происходит. То есть первые три этапа при сверхжадном режиме будут аналогичны жадному режиму. После захвата всей строки матчер добавляет остаток шаблона и сравнивает с захваченной строкой. В нашем примере при выполнении метода main с шаблоном "`А.++а`" совпадений не будет найдено. ![Регулярные выражения в Java - 7](https://cdn.javarush.com/images/article/43a0e49c-8e25-470c-bd80-1396334cb9a4/800.webp)

## Ленивый режим квантификатора

1. В этом режиме на начальном этапе, как и в жадном режиме, ищется совпадение с первым символом шаблона:
    
    ![Регулярные выражения в Java - 8](https://cdn.javarush.com/images/article/2e7f79db-6eba-464e-a3d0-f988ad46bd40/800.webp)
2. Далее ищется совпадение со следующим символом шаблона – любым символом:
    
    ![Регулярные выражения в Java - 9](https://cdn.javarush.com/images/article/e3046c84-473b-44d4-9873-a87e6fcb6a35/800.webp)
3. В отличие от жадного режима, в ленивом ищется самое короткое совпадение в тексте, поэтому после нахождения совпадения со вторым символом шаблона, который задан точкой и соответствует символу на позиции №6 текста, `Matcher` будет проверять соответствие текста остатку шаблона – символу «`а`»
    
    ![Регулярные выражения в Java - 10](https://cdn.javarush.com/images/article/b24fe49e-ab84-4884-be09-f0599628a10b/800.webp)
4. Поскольку совпадение с шаблоном в тексте не найдено (на позиции №7 в тексте находится символ «`л`»), `Matcher` добавляет еще один «любой символ» в шаблоне, так как он задан как один и более раз, и опять сравнивает шаблон с текстом на позициях с №5 по №8:
    
    ![Регулярные выражения в Java - 11](https://cdn.javarush.com/images/article/13543dd7-56bd-46d9-b466-d6e955b811e3/800.webp)
5. В нашем случае найдено совпадение, но конец текста ещё не достигнут. Поэтому с позиции №9 проверка начинается с поиска первого символа шаблона по аналогичному алгоритму и далее повторяется вплоть до окончания текста.
    
    ![Регулярные выражения в Java - 12](https://cdn.javarush.com/images/article/d77ca7c4-9281-4750-9199-800aff1130b0/800.webp)

В результате работы метода `main` при использовании шаблона "`А.+?а`" мы получим следующий результат: _Алла Алекса_ Как видно из нашего примера, при использовании разных режимов квантификатора для одного и того же шаблона мы получили разные результаты. Поэтому необходимо учитывать эту особенность и выбирать нужный режим в зависимости от желаемого результата при поиске.